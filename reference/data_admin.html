<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Encrypted data administration — data_admin_init • cyphr</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />
<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<link href="../ropensci.css" rel="stylesheet">

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>
<link href="../tidyverse-2.css" rel="stylesheet">



<meta property="og:title" content="Encrypted data administration — data_admin_init" />

<meta property="og:description" content="Encrypted data administration; functions for setting up, adding
users, etc." />
<meta name="twitter:card" content="summary" />



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a class="navbar-brand" href="../index.html">cyphr</a>
        <div class="info">
          <span class="partof">part of  <a href="https://ropensci.org"><img src='https://d33wubrfki0l68.cloudfront.net/88338b7637e084df5c43e7a9e6293719dbaf10e2/30903/img/icon_lettering_white.svg' height=24 alt = 'rOpenSci'/></a></span>
          <span class="version label label-default version-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.1</span>
        </div>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/cyphr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/data.html">Data Encryption</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
        <li>
  <a href="https://github.com/ropensci/cyphr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Encrypted data administration</h1>
    <small class="dont-index">Source: <a href='https://github.com/ropensci/cyphr/blob/master/R/data.R'><code>R/data.R</code></a></small>
    <div class="hidden name"><code>data_admin.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Encrypted data administration; functions for setting up, adding
users, etc.</p>
    
    </div>

    <pre class="usage"><span class='fu'>data_admin_init</span>(<span class='no'>path_data</span>, <span class='kw'>path_user</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>quiet</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)

<span class='fu'>data_admin_authorise</span>(<span class='no'>path_data</span>, <span class='kw'>hash</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>path_user</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>yes</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>quiet</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)

<span class='fu'>data_admin_list_requests</span>(<span class='no'>path_data</span>)

<span class='fu'>data_admin_list_keys</span>(<span class='no'>path_data</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>path_data</th>
      <td><p>Path to the data set.  We will store a bunch of
things in a hidden directory within this path.</p></td>
    </tr>
    <tr>
      <th>path_user</th>
      <td><p>Path to the directory with your ssh key.
Usually this can be omitted.</p></td>
    </tr>
    <tr>
      <th>quiet</th>
      <td><p>Suppress printing of informative messages.</p></td>
    </tr>
    <tr>
      <th>hash</th>
      <td><p>A vector of hashes to add.  If provided, each hash can
be the binary or string representation of the hash to add.  Or
omit to add each request.</p></td>
    </tr>
    <tr>
      <th>yes</th>
      <td><p>Skip the confirmation prompt?  If any request is
declined then the function will throw an error on exit.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>data_admin_init</code> initialises the system; it will create a
data key if it does not exist and authorise you.  If it already
exists and you do not have access it will throw an error.</p>
<p><code>data_admin_authorise</code> authorises a key by creating a key to
the data that the user can use in conjunction with their personal
key.</p>
<p><code>data_admin_list_requests</code> lists current requests.</p>
<p><code>data_admin_list_keys</code> lists known keys that can access the
data.  Note that this is <em>not secure</em>; keys not listed here
may still be able to access the data (if a key was authorised and
moved elsewhere for example).  Conversely, if the user has deleted
or changed their key they will not be able to access the data
despite the key being listed here.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='data_user.html'>data_request_access</a></code> for requesting access
  to the data, and and <code>data_key</code> for using the data
  itself.  But for a much more thorough overview, see the vignette
  (<code><a href='../articles/data.html'>vignette("data", package="cyphr")</a></code>).</p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'># The workflow here does not really lend itself to an example,</span>
<span class='co'># please see the vignette instead.</span>

<span class='co'># First we need a set of user ssh keys.  In a non example</span>
<span class='co'># environment your personal ssh keys will probably work well, but</span>
<span class='co'># hopefully they are password protected so cannot be used in</span>
<span class='co'># examples.  The password = FALSE argument is only for testing,</span>
<span class='co'># and should not be used for data that you care about.</span>
<span class='no'>path_ssh_key</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/tempfile'>tempfile</a></span>()
<span class='kw pkg'>cyphr</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/cyphr/topics/ssh_keygen'>ssh_keygen</a></span>(<span class='no'>path_ssh_key</span>, <span class='kw'>password</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)

<span class='co'># Initialise the data directory, using this key path.  Ordinarily</span>
<span class='co'># the path_user argument would not be needed because we would be</span>
<span class='co'># using your user ssh keys:</span>
<span class='no'>path_data</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/tempfile'>tempfile</a></span>()
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/files2'>dir.create</a></span>(<span class='no'>path_data</span>, <span class='fl'>FALSE</span>, <span class='fl'>TRUE</span>)
<span class='kw pkg'>cyphr</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/cyphr/topics/data_admin'>data_admin_init</a></span>(<span class='no'>path_data</span>, <span class='kw'>path_user</span> <span class='kw'>=</span> <span class='no'>path_ssh_key</span>)</div><div class='output co'>#&gt; <span class='message'>Generating data key</span></div><div class='output co'>#&gt; <span class='message'>Authorising ourselves</span></div><div class='output co'>#&gt; <span class='message'>Adding key b5:0b:1b:5b:ac:14:d2:75:12:2c:0f:6c:b8:7e:02:a3</span>
#&gt; <span class='message'>  user: rich</span>
#&gt; <span class='message'>  host: wpia-dide136.dide.ic.ac.uk</span>
#&gt; <span class='message'>  date: 2019-03-25 13:20:28</span></div><div class='output co'>#&gt; <span class='message'>Verifying</span></div><div class='input'>
<span class='co'># Now you can get the data key</span>
<span class='no'>key</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>cyphr</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/cyphr/topics/data_user'>data_key</a></span>(<span class='no'>path_data</span>, <span class='kw'>path_user</span> <span class='kw'>=</span> <span class='no'>path_ssh_key</span>)

<span class='co'># And encrypt things with it</span>
<span class='kw pkg'>cyphr</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/cyphr/topics/encrypt_data'>encrypt_string</a></span>(<span class='st'>"hello"</span>, <span class='no'>key</span>)</div><div class='output co'>#&gt;  [1] 94 ce 68 71 44 92 59 2e fc af ff f2 ef 8b b7 9e b3 68 a8 1a c0 50 0e 42 d6
#&gt; [26] 99 15 c9 c3 e1 67 4c 9e e3 bf dc ce a9 0b 89 73 d7 fa 5b 58</div><div class='input'>
<span class='co'># See the vignette for more details.  This is not the best medium</span>
<span class='co'># to explore this.</span>

<span class='co'># Cleanup</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/unlink'>unlink</a></span>(<span class='no'>path_ssh_key</span>, <span class='kw'>recursive</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/unlink'>unlink</a></span>(<span class='no'>path_data</span>, <span class='kw'>recursive</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div>
  <p>cyphr is a part of <img src='https://github.com/ropensci/logos/raw/master/icon_lettering_color.png' height=40 alt = 'rOpenSci'>. Learn more at <a href="https://ropensci.org">ropensci.org</a>.</p>
</div>

<div class="author">
  <p>
    Developed by Rich FitzJohn.
    Site built by <a href="https://pkgdown.r-lib.org">pkgdown</a>.
  </p>
</div>
      </footer>
   </div>

  

  </body>
</html>

